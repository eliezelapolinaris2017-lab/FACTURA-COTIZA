<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FACTURA-COTIZA</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <div class="layout">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="brand">
        <img id="brandLogo" src="assets/logo-placeholder.png" alt="Logo" />
        <h2>FACTURA-COTIZA</h2>
      </div>
      <nav>
        <button class="navlink active" data-nav="nuevo">ğŸ§¾ Nuevo</button>
        <button class="navlink" data-nav="historial">ğŸ“š Historial</button>
        <button class="navlink" data-nav="config">âš™ï¸ ConfiguraciÃ³n</button>
      </nav>
      <footer>
        <button id="btnLogin" class="btn btn-gold">ğŸ”‘ Iniciar sesiÃ³n</button>
        <button id="btnLogout" class="btn btn-dark" style="display:none">ğŸšª Cerrar sesiÃ³n</button>
      </footer>
    </aside>

    <!-- Main content -->
    <main class="main">
      <!-- NUEVO -->
      <section id="view-nuevo" class="view visible">
        <h1>ğŸ§¾ Nueva Factura o CotizaciÃ³n</h1>
        <form id="formDoc" class="card">
          <div class="grid">
            <label>Tipo:
              <select id="docType">
                <option value="FAC">Factura</option>
                <option value="COT">CotizaciÃ³n</option>
              </select>
            </label>
            <label>Fecha:
              <input type="date" id="docDate" required>
            </label>
            <label>Cliente:
              <input type="text" id="clientName" required placeholder="Nombre del cliente">
            </label>
            <label>TelÃ©fono:
              <input type="tel" id="clientPhone" placeholder="787-555-5555">
            </label>
            <label>Notas:
              <input type="text" id="docNotes" placeholder="Condiciones, notas, etc.">
            </label>
          </div>

          <h3>Servicios / Ãtems</h3>
          <table class="table" id="tblItems">
            <thead>
              <tr><th>Ãtem</th><th>DescripciÃ³n</th><th>Precio</th><th>Cant.</th><th>Importe</th><th></th></tr>
            </thead>
            <tbody id="linesBody"></tbody>
          </table>
          <button type="button" id="btnAddLine" class="btn">â• AÃ±adir lÃ­nea</button>

          <div class="totals">
            <label>Descuento %<input id="tDiscPct" type="number" step="0.01" value="0"></label>
            <label>IVU %<input id="tTaxPct" type="number" step="0.01" value="0"></label>
            <div>Subtotal: <b id="tSubtotal">$0.00</b></div>
            <div>Descuento: <b id="tDiscAmt">$0.00</b></div>
            <div>Impuesto: <b id="tTaxAmt">$0.00</b></div>
            <div>Total: <b id="tTotal">$0.00</b></div>
          </div>

          <div class="toolbar">
            <button type="button" id="btnPrint" class="btn">ğŸ“„ PDF</button>
            <button type="submit" class="btn btn-gold">ğŸ’¾ Guardar</button>
          </div>
        </form>
      </section>

      <!-- HISTORIAL -->
      <section id="view-historial" class="view">
        <h1>ğŸ“š Historial</h1>
        <div class="toolbar">
          <button id="btnReload" class="btn">ğŸ”„ Recargar</button>
          <button id="btnCsv" class="btn btn-gold">ğŸ“¤ Exportar CSV</button>
        </div>
        <div id="listDocs" class="list"></div>
      </section>

      <!-- CONFIGURACIÃ“N -->
      <section id="view-config" class="view">
        <h1>âš™ï¸ ConfiguraciÃ³n del Negocio</h1>
        <form id="formCfg" class="card">
          <label>Nombre de la empresa:
            <input type="text" id="cfgName" required>
          </label>
          <label>TelÃ©fono:
            <input type="tel" id="cfgPhone" required>
          </label>
          <label>Logo para Factura:
            <input type="file" id="cfgLogoFAC" accept="image/*">
          </label>
          <label>Logo para CotizaciÃ³n:
            <input type="file" id="cfgLogoCOT" accept="image/*">
          </label>
          <div class="logos">
            <img id="prevFAC" class="preview" alt="Logo FAC">
            <img id="prevCOT" class="preview" alt="Logo COT">
          </div>
          <button type="submit" class="btn btn-gold">ğŸ’¾ Guardar ConfiguraciÃ³n</button>
        </form>
      </section>
    </main>
  </div>

  <!-- Ãrea PDF -->
  <section id="printArea">
    <div class="print-card">
      <header class="p-head">
        <img id="pLogo" class="p-logo" />
        <div>
          <h2 id="pType">FACTURA</h2>
          <div id="pBizName"></div>
          <div id="pBizPhone"></div>
          <div id="pDate"></div>
        </div>
      </header>

      <section class="p-client">
        <p><b>Cliente:</b> <span id="pClientName"></span></p>
        <p><b>TelÃ©fono:</b> <span id="pClientPhone"></span></p>
        <p><b>Notas:</b> <span id="pNotes"></span></p>
      </section>

      <table class="p-table">
        <thead><tr><th>Ãtem</th><th>DescripciÃ³n</th><th>Precio</th><th>Cant.</th><th>Importe</th></tr></thead>
        <tbody id="pLines"></tbody>
      </table>

      <section class="p-totals">
        <p>Subtotal: <b id="pSubtotal">$0.00</b></p>
        <p>Descuento: <b id="pDiscAmt">$0.00</b></p>
        <p>Impuesto: <b id="pTaxAmt">$0.00</b></p>
        <p class="total">Total: <b id="pTotal">$0.00</b></p>
      </section>
    </div>
  </section>

  <!-- Scripts al final (orden correcto) -->
  <script type="module" src="./firebase-init.js"></script>
  <script type="module" src="./app.js"></script>
</body>
</html>
